%define INSTANCEHOME ./instance
instancehome $INSTANCEHOME

%define CLIENTHOME ./instance/var
clienthome $CLIENTHOME

debug-mode on
security-policy-implementation C
default-zpublisher-encoding utf-8

<environment>
    zope_i18n_compile_mo_files true
</environment>

# Database â€” using zodb-pgjsonb with S3 blob tiering
%import zodb_pgjsonb

<zodb_db main>
    mount-point /
    cache-size 30000
    <pgjsonb>
        dsn dbname=zodb user=zodb password=zodb host=localhost port=5433
        blob-temp-dir ./instance/var/blobtemp
        blob-cache-dir ./instance/var/blobcache

        # S3 tiered blob storage (MinIO)
        s3-bucket-name zodb-blobs
        s3-endpoint-url http://localhost:9000
        s3-access-key minioadmin
        s3-secret-key minioadmin
        s3-use-ssl false
        blob-threshold 1MB
    </pgjsonb>
</zodb_db>
